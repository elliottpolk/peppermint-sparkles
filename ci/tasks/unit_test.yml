platform: linux
image_resource:
  type: docker-image
  source:
    insecure_registries: ["10.234.24.211:443"]
    repository: 10.234.24.211:443/go-dep
    tag: latest
inputs:
- name: peppermint-sparkles
  path: /src/gitlab.manulife.com/oa-montreal/peppermint-sparkles
run:
  path: sh
  args:
    - -exec
    - |
      export GOPATH=${PWD}
      cd $GOPATH/src/gitlab.manulife.com/oa-montreal/peppermint-sparkles
      dep ensure -v && \
      go test -v -cover ./... && \
      go test -v -cover -tags="integration" ./...
